<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp
  xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
  xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.0"
  xsi:type="MailApp">


  <!-- Basic Add-in Info -->
  <Id>12345678-1234-1234-1234-123456789abc</Id>
  <Version>1.0.0.0</Version>
  <ProviderName>SecurityCheck</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>

  <DisplayName DefaultValue="SecurityCheck Add-In"/>
  <Description DefaultValue="Validates recipients before sending email."/>
  <IconUrl DefaultValue="https://localhost:3000/assets/icon.png"/>
  <SupportUrl DefaultValue="https://localhost:3000/support.html"/>

  <!-- Host -->
  <Hosts>
    <Host Name="Mailbox"/>
  </Hosts>

  <!-- Requirement set for OnMessageSend -->
  <Requirements>
    <Sets DefaultMinVersion="1.12">
      <Set Name="Mailbox"/>
    </Sets>
  </Requirements>

  <!-- Dummy form block required by legacy schema -->
  <FormSettings>
    <Form xsi:type="ItemRead">
      <DesktopSettings>
        <SourceLocation DefaultValue="https://localhost:3000/placeholder.html"/>
        <RequestedHeight>250</RequestedHeight>
      </DesktopSettings>
    </Form>
  </FormSettings>

  <!-- Modern event-based declaration -->
  <VersionOverrides Version="1.0" xmlns="http://schemas.microsoft.com/office/mailappversionoverrides/1.0">
    <Hosts>
      <Host Name="Mailbox">
        <Runtimes>
          <Runtime resid="functionFile" lifetime="short"/>
        </Runtimes>
        <ExtensionPoints>
          <ExtensionPoint xsi:type="Events">
            <Event Type="OnMessageSend" FunctionName="onMessageSendHandler"/>
          </ExtensionPoint>
        </ExtensionPoints>
      </Host>
    </Hosts>
    <Resources>
      <bt:Urls>
        <bt:Url id="functionFile" DefaultValue="https://localhost:3000/functions.html"/>
      </bt:Urls>
    </Resources>
  </VersionOverrides>
</OfficeApp>